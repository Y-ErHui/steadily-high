[TOC]

# 05-01

### 1. 高阶函数

- 定义：如果一个函数接受另一个函数作为参数，那么我们就称该函数为高阶函数

- JavaScript 中常见的高阶函数

  - `forEach`、`map`、`reduce`、`filter` 等

  - 具体实现

    - forEach

      ```js
      // 实现
      Array.prototype.myForEach = function (callback) {
        var len = this.length;
        if (typeof callback !== "function") {
          throw new Error("must be function");
        }
        for (var i = 0; i < len; i++) {
          callback.call(this, this[i], i);
        }
      };
      
      // 运用
      var arr = [1, 2, 3];
      arr.myForEach((item) => {
        item = item * 2;
      });
      ```

    - map

      ```js
      // 实现
      Array.prototype.myMap = function (callback) {
        var len = this.length;
        var arr = [];
        if (typeof callback !== "function") {
          throw new Error("must be function");
        }
        for (var i = 0; i < len; i++) {
          arr.push(callback.call(this, this[i], i));
        }
        return arr;
      };
      
      // 运用
      var arr = [1, 2, 3];
      const mapResult = arr.myMap((item) => item * 2);
      ```

    - filter

      ```js
      // 实现
      Array.prototype.myFilter = function (fn) {
        var _newArray = [];
        var len = this.length;
        for (var i = 0; i < len; i++) {
          if (fn.call(this, this[i], i)) {
            if (typeof this[i] === "object") {
              _newArray.push(Object.create(this[i]));
            } else {
              _newArray.push(this[i]);
            }
          }
        }
        return _newArray;
      };
      
      // 运用
      var arr = [1, 2, 3, 4, 5, 6];
      const filterResult = arr.myFilter((current, index) => current % 2 === 0);
      ```

    - reduce

      ```js
      // 实现
      Array.prototype.myReduce = function (fn, init) {
        var i = 0;
        var len = this.length;
        var pre = init;
        if (init == undefined) {
          pre = this[0];
          i = 1;
        }
        for (i; i < len; i++) {
          pre = fn.call(this, pre, this[i], i, this);
        }
        return pre;
      };
      
      // 运用
      // 累加
      var arr = [1, 2, 3];
      const reduceResult = arr.reduce((pre, now, index, arr) => pre + now, 10);
      // type === 'yes' 的 num 相加
      var arr2 = [
        { type: "yes", num: 1 },
        { type: "no", num: 2 },
        { type: "yes", num: 3 },
      ];
      const yesReduceResult = arr2.reduce((pre, current) => {
        if (current.type === "yes") {
          pre += current.num;
        }
        return pre;
      }, 0);
      // vue-router
      var routes = [
        { path: "/", components: "home" },
        { path: "/login", components: "login" },
      ];
      const routeReduceResult = routes.reduce((pre, current) => {
        pre[current.path] = current.components;
        return pre;
      }, {});
      ```

- 编写高阶函数

  - 需要注意的点

    - 保持纯函数，减少函数副作用

    - 调用选择 `call` 还是 `apply`

      call：给回调的参数是指定的数量并且能够找到 

      apply：参数不定，可用 `arguments` 传入

  - 例

    找出对象中符合要求的属性名

    ```js
    function findProperty(obj, fn) {
      var _obj = Object.create(obj);
      var _propertyArr = [];
      for (var key in _obj) {
        if (fn.call(_obj, _obj[key], key)) {
          _propertyArr.push(key);
        }
      }
      return _propertyArr;
    }
    var obj = { num1: 1, num2: 2, nuum3: 3, num4: 4, num5: 5, num6: 6 };
    const findPropertyResult = findProperty(obj, (value, key) => value % 2 === 0);
    ```

### 2. 函数柯里化

- 定义：把接受多个参数的函数变换成接受一个单一参数（最初函数的第一个参数）的函数，并且返回接受余下的参数，而且返回结果的新函数的技术

- 为什么要柯里化

  - 我们不方便传入参数

    ```js
    // Promice => bind
    function add(num) {
      console.log(num);
    }
    Promise.resolve().then(add.bind(this, 123));
    ```

  - 我们写了一个方法，但是这个方法很多时候调用起来参数是固定的

    ```js
    // 验证表单
    function inputTest(reg, value) {
      if (!reg.test(value)) {
        throw new Error("请输入纯数字");
      }
      console.log(`${value} 验证通过`);
    }
    
    // 是否是纯数字 (有多个表单需要验证)
    // 未柯里化
    inputTest(/^[0-9]*$/, 123);
    inputTest(/^[0-9]*$/, 'hello');
    // 柯里化
    const numberTest = inputTest.bind(this, /^[0-9]*$/)
    numberTest(123)
    numberTest('hello')
    ```

- 如何实现柯里化